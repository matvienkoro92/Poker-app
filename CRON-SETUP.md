# Настройка напоминаний «за час» и «за 10 мин»

Турнир в **понедельник в 4:15 (Бали, UTC+8)** → напоминание «за 10 мин» в **4:05 Бали** (только понедельник).

## Шаг 1. Добавить CRON_SECRET в Vercel

1. Сгенерируйте пароль: https://randomkeygen.com
2. Vercel → **Settings** → **Environment Variables**
3. Добавьте:
   - **Name:** `CRON_SECRET`
   - **Value:** сгенерированный пароль
4. **Save** → **Redeploy**

## Шаг 2. cron-job.org

1. Зарегистрируйтесь на https://cron-job.org
2. **Create Cronjob** (за 10 мин):
   - URL: `https://poker-app-ebon.vercel.app/api/freeroll-reminder-send?when=10min&secret=ВАШ_CRON_SECRET`
   - Schedule: **Каждый понедельник, 04:05** (часовой пояс **Asia/Makassar**)
   - Включите задачу (Enabled)

## Тест вручную

В приложении — кнопка «Тест: отправить «за 10 мин» сейчас» (работает без CRON_SECRET).

Через браузер (подставьте свой CRON_SECRET, без initData разошлёт всем подписчикам):
- `https://poker-app-ebon.vercel.app/api/freeroll-reminder-send?when=10min&secret=ВАШ_CRON_SECRET`

## Проверка подписчиков

Откройте `/api/debug-env?reminders=1` — увидите, сколько подписчиков в «за час» и «за 10 мин». Если 0 — нажмите кнопку в приложении для подписки.

## «За 10 мин» не приходит — что проверить

1. **Задача в cron-job.org** — задача с `when=10min` создана и включена?
2. **Подписка** — вы нажали кнопку «Напомнить за 10 минут»?
3. **Проверка подписчиков** — откройте `/api/debug-env?reminders=1`. Если `subscribers10min` = 0 — никто не подписан.
4. **Тест** — в приложении нажмите «Тест: отправить «за 10 мин» сейчас». Если пришло — доставка работает, проблема в cron.
5. **CRON_SECRET** — в URL тот же `secret`, что в Vercel.

## Итог

После настройки нажмите в приложении «Напомнить за 10 минут» — подписка сохранится. Сообщение придёт в понедельник в 4:05 по Бали (если cron-job.org вызывает URL вовремя).
